<!DOCTYPE html><html lang="fr-fr"><head>
		<meta charset="utf-8">
		<title>NodeAtlas &#x2014;Le Framework JavaScript Serveur &#xC9;volutif&#x2014;</title>

		<base href="">

		<meta name="geo.placename" content="Annecy, Haute-Savoie, France">
		<meta name="description" content="Cr&#xE9;ez simplement des sites web &#xE9;volutifs en Node.js.">

		<meta name="og:title" content="NodeAtlas &#x2014;Le Framework JavaScript Serveur &#xC9;volutif&#x2014;">
		<meta name="og:description" content="Cr&#xE9;ez simplement des sites web &#xE9;volutifs en Node.js.">
		<meta name="og:url" content="https://node-atlas.js.org">
		<meta name="og:image" content="https://node-atlas.js.org/media/images/min/logo-big.png">
		<meta name="og:locale" content="fr-fr">
		<meta name="og:type" content="website">
		<meta name="og:updated_time" content="1505578890965">

		<meta name="robots" content="index, follow">

		<!--[if IE]><meta name="viewport" content="width=device-width, user-scalable=no" /><![endif]-->
		<!--[if !IE]><!--><meta name="viewport" content="initial-scale=1.0, user-scalable=no"><!--<![endif]-->

		<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/default.min.css">

		<!-- Inclusion du fichiers minifié après génération. -->
		
		<link rel="stylesheet" href="stylesheets/common.min.css">

		<!-- Inclusion du fichiers standar pendant le développement. -->
		
	</head>
	<body data-content="content/" data-subpath="" style="background-image: url(&apos;media/images/min/main-background.jpg&apos;);">
		<div class="layout">
			<noscript class="no-js cmpt">
				<div class="no-js--inner">
					<p>Le JavaScript n'est pas activé.</p>
				</div>
			</noscript>
			<div class="background"></div>
			<div class="language cmpt">
				<div class="navigation--lang">
					<a href="/english/index.html" title="International Version"><span class="fa fa-globe"></span>  International Version</a>
				</div>
			</div>
			<header class="header cmpt">
				<div class="header--inner">
					<div class="header--information">
						<div class="header--information--github">
							<a class="header--information--donate" href="https://www.paypal.me/BrunoLesieur/5"><img src="https://img.shields.io/badge/don-%E2%9D%A4-ddddff.svg" alt="Faites un don" data-canonical-src="https://img.shields.io/badge/don-%E2%9D%A4-ddddff.svg"></a>
							<a class="header--information--follow github-button" href="https://github.com/Haeresis" data-count-href="/Haeresis/followers" data-count-api="/users/Haeresis#followers" data-count-aria-label="# followers on GitHub" aria-label="Suivre @Haeresis on GitHub">Suivre</a>
						</div>
						<div class="header--information--npm">
							<a class="header--information--package" href="https://www.npmjs.com/package/node-atlas"><img src="https://badge.fury.io/js/node-atlas.svg" alt="Package NPM" data-canonical-src="https://badge.fury.io/js/node-atlas.svg"></a>
							<a class="header--information--star github-button" href="https://github.com/NodeAtlas/node-atlas" data-icon="octicon-star" data-count-href="/NodeAtlas/node-atlas/stargazers" data-count-api="/repos/NodeAtlas/node-atlas#stargazers_count" data-count-aria-label="# stargazers on GitHub" aria-label="Star NodeAtlas/node-atlas on GitHub">Star</a>
						</div>
					</div>
					<div class="header--background"></div>
					<div class="header--title">
						<h1>
							<img class="header--title--node" src="media/images/min/ode.png" alt="Node">
							<img class="header--title--atlas" src="media/images/min/tlas.png" alt="Atlas">
							<img class="header--title--trans" src="media/images/min/transparent.png" alt="NodeAtlas">
						</h1>
					</div>
					<div class="header--abstract">
						<p>Le Framework JavaScript Serveur &#xC9;volutif</p>
					</div>
					<div class="header--main">
						<ul>
							<li>
								<div class="header--main--first">
									<h2><span>Mise en place</span> <strong>Simple</strong></h2>
									<p>Au point avec <strong>HTML &amp; CSS</strong> ?<br><strong>D&#xE9;butant</strong> en JavaScript ?</p>
									<p class="small">R&#xE9;alisez rapidement des sites vitrines multilingues sans effort avec l&apos;utilisation de routes, vues ou variations.</p>
								</div>
							</li>
							<li>
								<div class="header--main--second">
									<h2><span>Site vivant et</span> <strong>&#xC9;volutif</strong></h2>
									<p><strong>Expert</strong> en JavaScript client ?<br>Pr&#xEA;t &#xE0; embrasser <strong>Node.js</strong> ?</p>
									<p class="small">Am&#xE9;liorer progressivement votre base &#xE0; mesure de vos besoins en utilisant des contr&#xF4;leurs, mod&#xE8;les ou modules.</p>
								</div>
							</li>
							<li>
								<div class="header--main--third">
									<h2><span>Partie Cliente</span> <strong>Agnostique</strong></h2>
									<p>D&#xE9;j&#xE0; vos habitudes <strong>Front-end</strong> ?<br>Habitu&#xE9;(e) du <strong>Data Binding</strong> ?</p>
									<p class="small">Du l&#xE9;ger Vanilla au simple jQuery en passant par Vue, Angular ou React : utiliser vos biblioth&#xE8;ques clientes favorites !</p>
								</div>
							</li>
						</ul>
					</div>
				</div>
			</header>
<div class="popup cmpt">
	<aside class="popup--inner">
		<div class="popup--versus"><del class="close">Fermer</del><span class="fa fa-bolt" aria-hidden="true"></span><ins class="versus">Versus</ins></div>
		<div class="popup--nodeatlas"></div>
		<div class="popup--challenger"></div>
	</aside>
</div>
			<aside class="download cmpt">
				<div class="download--inner">
					<div class="download--install">
						<div class="download--cli is-active">
							<h2>Utilisation CLI</h2>
							<div class="download--cli--inner">
								<div class="download--cli--step1">
									<h3>Installer NodeAtlas</h3>
									<pre>$ npm install -g node-atlas</pre>
								</div>
								<div class="download--cli--step2">
									<h3>Cr&#xE9;er un site test</h3>
									<pre>$ node-atlas --create</pre>
								</div>
								<div class="download--cli--step3">
									<h3>Lancer le site</h3>
									<pre>$ node-atlas --browse</pre>
								</div>
							</div>
						</div>
						<div class="download--api">
							<h2>Utilisation API</h2>
							<div class="download--api--inner">
								<div class="download--api--step1">
									<h3>Installer NodeAtlas</h3>
									<pre>$ npm install node-atlas</pre>
								</div>
								<div class="download--api--step2">
									<h3>Cr&#xE9;er un script</h3>
									<pre><span>server.js</span>var NA = require(&quot;node-atlas&quot;),
    website = NA();
website.init({
    &quot;create&quot;: &quot;hello-world&quot;
}).created(function () {
    website.run({
        &quot;browse&quot;: true
    });
}).start();</pre>
								</div>
								<div class="download--api--step3">
									<h3>Lancer le site</h3>
									<pre>$ node server.js</pre>
								</div>
							</div>
						</div>
					</div>
					<div class="download--clone">
						<div class="download--version">
							<h2>T&#xE9;l&#xE9;charger</h2>
							<div class="download--version--inner">
								<div class="download--version--step1">
									<h3>v2.0.0-beta50</h3>
									<p class="download--clone--last"><a class="button" href="https://github.com/NodeAtlas/node-atlas/archive/master.zip" target="_blank">Derni&#xE8;re version</a></p>
									<p class="aside"><a href="https://github.com/NodeAtlas/node-atlas/releases">Versions stables</a></p>
								</div>
								<div class="download--version--step2">
									<h3>Cloner</h3>
									<p><input type="text" name="clone" data-instruction="Copier dans le presse-papier: Ctrl+C, Entrer" class="download--clone--text" value="https://github.com/NodeAtlas/node-atlas.git"><button><span class="fa fa-clipboard" aria-hidden="true"></span></button></p>
								</div>
							</div>
						</div>
					</div>
					<div class="download--battle">
						<div class="download--slide">
							<h2>Batailles Versus</h2>
							<div class="download--slide--inner">
								<div class="download--slide--step1">
									<img src="media/images/battles/node-atlas.png" alt="NodeAtlas API">
								</div>
								<div class="download--slide--step2">
									VS
								</div>
								<div class="download--slide--step3">
									<img src="media/images/battles/expressjs.png" alt="Concurrent">
								</div>
								<div class="download--slide--step4">
									<span class="fa fa-refresh" aria-hidden="true">
								</span></div>
							</div>
						</div>
					</div>
					<div class="download--info">
						<div class="download--tuto is-active">
							<h2>Tutoriaux</h2>
							<div class="download--tuto--inner">
								<div class="download--tuto--step1">
									<a href="avant-propos.html#avant-propos"><span>D&#xE9;couvrir</span> <i class="fa fa-book" aria-hidden="true"></i> le guide complet pas &#xE0; pas</a>
								</div>
								<div class="download--tuto--step2">
									<span>ou</span>
								</div>
								<div class="download--tuto--step3">
									<div class="download--tuto--step3--first">
										<a href="https://blog.lesieur.name/des-sites-web-nodejs-pour-les-debutants-en-javascript-avec-nodeatlas/"><span>Cr&#xE9;er</span> <i class="fa fa-html5" aria-hidden="true"></i> des sites web multilingues</a>
									</div>
									<div class="download--tuto--step3--second">
										<a href="https://blog.lesieur.name/creer-et-maintenir-des-maquettes-html-avec-node-atlas/"><span>Maintenir</span> <i class="fa fa-copy" aria-hidden="true"></i> des maquettes HTML sans serveur</a>
									</div>
									<div class="download--tuto--step3--third">
										<a href="https://github.com/NodeAtlas"><span>D&#xE9;velopper</span> <i class="fa fa-database" aria-hidden="true"></i> des applications web temps r&#xE9;el</a>
									</div>
								</div>
							</div>
						</div>
						<div class="download--about">
							<h2>&#xC0; propos</h2>
							<div class="download--about--inner">
								<div class="download--about--step1">
									NodeAtlas est un Framework JavaScript MVC(2) c&#xF4;t&#xE9; serveur vous permettant de cr&#xE9;er des sites &#xE9;volutifs, SEO-compliant et W3C-compliant. C&apos;est-&#xE0;-dire qu&apos;il permet de faire tourner des pages multilingues indexables ou de cr&#xE9;er des maquettes HTML et passant la validation W3C uniquement avec des vues avec modifications &#xE0; chaud mais &#xE9;galement de cr&#xE9;er de gros sites orient&#xE9;s composants et/ou orient&#xE9;s services en respectant les nouveaux standards !
								</div>
							</div>
						</div>
					</div>
				</div>
			</aside>
			<nav class="navigation cmpt">
				<div class="navigation--outer">
					<div class="navigation--start"><button class="button">Commencer</button></div>
					<div class="navigation--documentation"><button class="button">Documentation</button></div>
				</div>
				<div class="navigation--inner">
					<div class="navigation--lang">
						<a href="/english/index.html" title="International Version"><span class="fa fa-globe"></span>  International Version</a>
					</div>
					<div class="navigation--home">
						<img class="navigation--home--logo" src="media/images/logo.png" alt="Guide &lt;span&gt;NodeAtlas&lt;/span&gt;" width="80px"> <a class="navigation--home--back" href="index.html" title="Guide &lt;span&gt;NodeAtlas&lt;/span&gt;">Guide <span>NodeAtlas</span></a>
					</div>
					<div class="navigation--menu">
						<div class="navigation--menu--toggle">
							<span class="top"></span>
							<span class="middle"></span>
							<span class="bottom"></span>
						</div>
						<div class="navigation--menu--list">
							<div class="navigation--menu--list--inner">
								<h2>Menu</h2>
								<ul>
									
									<li>
										<a href="avant-propos.html" title="Pr&#xE9;sentation">Pr&#xE9;sentation</a> 
										
										<i class="fa fa-chevron-down" aria-hidden="true"></i>
										<ul>
											
											<li>
												<a href="installation.html" title="Installation">Installation</a>
											</li>
											
											<li>
												<a href="commencer-avec-nodeatlas.html" title="D&#xE9;marrage rapide">D&#xE9;marrage rapide</a>
											</li>
											
										</ul>
										
									</li>
									
									<li>
										<a href="partie-vue-et-template.html" title="Vue et Template">Vue et Template</a> 
										
									</li>
									
									<li>
										<a href="partie-controleur-et-modele.html" title="Contr&#xF4;leur et Mod&#xE8;le">Contr&#xF4;leur et Mod&#xE8;le</a> 
										
									</li>
									
									<li>
										<a href="pour-aller-plus-loin.html" title="Route et Plus">Route et Plus</a> 
										
										<i class="fa fa-chevron-down" aria-hidden="true"></i>
										<ul>
											
											<li>
												<a href="anatomie-du-webconfig.html" title="Webconfig">Webconfig</a>
											</li>
											
											<li>
												<a href="api-nodeatlas-comme-module-npm.html" title="API">API</a>
											</li>
											
											<li>
												<a href="cli-commandes-de-lancement.html" title="CLI">CLI</a>
											</li>
											
											<li>
												<a href="nodeatlas-comme-simple-serveur-web.html" title="Simple Serveur">Simple Serveur</a>
											</li>
											
											<li>
												<a href="environnement-de-developpement.html" title="D&#xE9;veloppement">D&#xE9;veloppement</a>
											</li>
											
											<li>
												<a href="environnement-de-production.html" title="Production">Production</a>
											</li>
											
										</ul>
										
									</li>
									
									<li>
										<a href="plus-sur-nodeatlas.html" title="Et les autres ?">Et les autres ?</a> 
										
									</li>
									
								</ul>
							</div>
						</div>
					</div>
				</div>
			</nav>
			<div class="content cmpt">
				<div class="content--outer" data-name="Menu"></div>
				<div class="content--inner">
					<h2 id="partie-vue-et-template">Partie vue et template</h2><p>NodeAtlas fonctionne avec une configuration via l&apos;utilisation d&apos;un <code>webconfig.json</code> qui lui permet d&apos;&#xE9;tendre les possibilit&#xE9;s du site de mani&#xE8;re &#xE9;volutive tout au long de sa vie. Par exemple, pour cr&#xE9;er un site sans JavaScript c&#xF4;t&#xE9; serveur (pas de contr&#xF4;leur), il suffit de ne renseigner qu&apos;un param&#xE8;tre <code>view</code> pour chaque route.</p><p>Cependant, vous pourrez toujours utiliser du JavaScript dans les templates des vues gr&#xE2;ce &#xE0; l&apos;utilisation du moteur de template <a href="http://ejs.co/">EJS</a> avec lequel fonctionne NodeAtlas par d&#xE9;faut.</p><p>Voyons les possibilit&#xE9;s de nos sites par agr&#xE9;gat simple de fichiers de vue.</p><h3 id="plusieurs-pages">Plusieurs pages</h3><p>Ci-dessous un exemple de configuration.</p><pre><code class="lang-json">{
    &quot;viewsRelativePath&quot;: &quot;views&quot;,
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;index.htm&quot;
        },
        &quot;/membre.html&quot;: {
            &quot;view&quot;: &quot;member.htm&quot;,
            &quot;post&quot;: false
        },
        &quot;/membre-sans-extension/&quot;: {
            &quot;view&quot;: &quot;member.htm&quot;,
            &quot;get&quot;: false
        },
        &quot;a-propos.html&quot;: {
            &quot;view&quot;: &quot;about.htm&quot;
        },
        &quot;/erreur.html&quot;: {
            &quot;view&quot;: &quot;error.htm&quot;,
            &quot;statusCode&quot;: 404,
            &quot;mimeType&quot;: &quot;text/plain&quot;
        }
    }
}
</code></pre><p>Pour faire tourner cet ensemble de fichier :</p><pre><code>&#x251C;&#x2500; views/
&#x2502;  &#x251C;&#x2500; about.htm
&#x2502;  &#x251C;&#x2500; error.htm
&#x2502;  &#x251C;&#x2500; index.htm
&#x2502;  &#x2514;&#x2500; member.htm
&#x2514;&#x2500; webconfig.json
</code></pre><p>aux adresses :</p><ul>
<li><em><a href="http://localhost/">http://localhost/</a></em> (r&#xE9;pond &#xE0; la racine),</li>
<li><em><a href="http://localhost/membre.html">http://localhost/membre.html</a></em> (ne r&#xE9;pondra pas si demand&#xE9;e en POST),</li>
<li><em><a href="http://localhost/membre-sans-extension/">http://localhost/membre-sans-extension/</a></em> (ne r&#xE9;pondra pas si demand&#xE9;e en GET),</li>
<li><em><a href="http://localhost/a-propos.html">http://localhost/a-propos.html</a></em> (renvoi &#xAB; Cannot GET about.html &#xBB; car le contenu d&apos;une route doit <strong>obligatoirement</strong> commencer par un <code>/</code> pour &#xEA;tre r&#xE9;f&#xE9;renc&#xE9;e),</li>
<li><em><a href="http://localhost/erreur.html">http://localhost/erreur.html</a></em> (renvoi du contenu plein texte (sans balise) avec une erreur 404).</li>
</ul><p><em>Note : si</em> <code>viewsRelativePath</code> <em>n&apos;est pas pr&#xE9;sent dans <code>webconfig.json</code>, par d&#xE9;faut le dossier des vues est bien</em> <code>views</code>. <code>viewsRelativePath</code> <em>est donc utile seulement pour changer le nom/chemin du r&#xE9;pertoire.</em></p><h3 id="referencer-ses-routes">R&#xE9;f&#xE9;rencer ses routes</h3><p>La configuration ci-dessous est &#xE9;quivalente &#xE0; la configuration de la section juste au-dessus</p><pre><code class="lang-json">{
    &quot;viewsRelativePath&quot;: &quot;views&quot;,
    &quot;routes&quot;: {
        &quot;/&quot;: &quot;index.htm&quot;,
        &quot;/membre.html&quot;: {
            &quot;view&quot;: &quot;member.htm&quot;,
            &quot;post&quot;: false
        },
        &quot;/membre-sans-extension/&quot;: {
            &quot;view&quot;: &quot;member.htm&quot;,
            &quot;get&quot;: false
        },
        &quot;a-propos.html&quot;: &quot;about.htm&quot;,
        &quot;/erreur.html&quot;: {
            &quot;view&quot;: &quot;error.htm&quot;,
            &quot;statusCode&quot;: 404,
            &quot;mimeType&quot;: &quot;text/plain&quot;
        }
    }
}
</code></pre><p>car</p><pre><code class="lang-json">&quot;/&quot;: &quot;index.htm&quot;,
</code></pre><p>est un raccourci de</p><pre><code class="lang-json">&quot;/&quot;: {
    &quot;view&quot;: &quot;index.htm&quot;
}
</code></pre><p>&#xC9;videmment ce raccourci ne sert que si <code>view</code> est le seul param&#xE8;tre &#xE0; d&#xE9;clarer de la route.</p><h4 id="ordonner-les-routes">Ordonner les routes</h4><p>Il est &#xE9;galement possible de placer ses routes dans un tableau, ce qui permettra de les prioriser lors de leur manipulation ult&#xE9;rieure dans la section des contr&#xF4;leurs.</p><p>Dans ce cas le chemin devient le param&#xE8;tre <code>url</code>.</p><pre><code class="lang-json">{
    &quot;viewsRelativePath&quot;: &quot;views&quot;,
    &quot;routes&quot;: [{
        &quot;url&quot;: &quot;/&quot;,
        &quot;view&quot;: &quot;index.htm&quot;
    }, {
        &quot;url&quot;: &quot;/membre.html&quot;,
        &quot;view&quot;: &quot;member.htm&quot;,
        &quot;post&quot;: false
    }, {
        &quot;url&quot;: &quot;/membre-sans-extension/&quot;,
        &quot;view&quot;: &quot;member.htm&quot;,
        &quot;get&quot;: false
    }, {
        &quot;url&quot;: &quot;a-propos.html&quot;,
        &quot;view&quot;: &quot;about.htm&quot;
    }, {
        &quot;url&quot;: &quot;/erreur.html&quot;,
        &quot;view&quot;: &quot;error.htm&quot;,
        &quot;statusCode&quot;: 404,
        &quot;mimeType&quot;: &quot;text/plain&quot;
    }]
}
</code></pre><h4 id="routage-dans-un-fichier-partag-">Routage dans un fichier partag&#xE9;</h4><p>Afin de ne pas r&#xE9;&#xE9;crire une longue liste de route dans un fichier <code>webconfig.json</code> &#xE0; destination de votre environnement de d&#xE9;veloppement et <code>webconfig.prod.json</code> &#xE0; destination de votre environnement de production, vous pouvez mutualiser la d&#xE9;claration des routes dans un fichier de votre choix. Par convention, c&apos;est le fichier <code>routes.json</code>.</p><p>Par exemple :</p><p>L&apos;ensemble de fichier suivant</p><pre><code>&#x251C;&#x2500; views/
&#x2502;  &#x2514;&#x2500; index.htm
&#x251C;&#x2500; webconfig.json
&#x2514;&#x2500; webconfig.prod.json
</code></pre><p>avec <code>webconfig.json</code></p><pre><code class="lang-json">{
    &quot;httpPort&quot;: 7777,
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;index.htm&quot;
        }
    }
}
</code></pre><p>et avec <code>webconfig.prod.json</code></p><pre><code class="lang-json">{
    &quot;httpPort&quot;: 7776,
    &quot;httpHostname&quot;: &quot;blog.lesieur.name&quot;,
    &quot;urlPort&quot;: 80,
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;index.htm&quot;
        }
    }
}
</code></pre><p>pourrait devenir l&apos;ensemble de fichier suivant</p><pre><code>&#x251C;&#x2500; views/
&#x2502;  &#x2514;&#x2500; index.htm
&#x251C;&#x2500; routes.json
&#x251C;&#x2500; webconfig.json
&#x2514;&#x2500; webconfig.prod.json
</code></pre><p>avec <code>webconfig.json</code></p><pre><code class="lang-json">{
    &quot;httpPort&quot;: 7777,
    &quot;routes&quot;: &quot;routes.json&quot;
}
</code></pre><p>avec <code>webconfig.prod.json</code></p><pre><code class="lang-json">{
    &quot;httpPort&quot;: 7776,
    &quot;httpHostname&quot;: &quot;blog.lesieur.name&quot;,
    &quot;urlPort&quot;: 80,
    &quot;routes&quot;: &quot;routes.json&quot;
}
</code></pre><p>et <code>routes.json</code></p><pre><code class="lang-json">{
    &quot;/&quot;: {
        &quot;view&quot;: &quot;index.htm&quot;
    }
}
</code></pre><p><em>Note: vous pouvez vous cr&#xE9;er plusieurs fichiers de routes comme <code>routes.en.json</code> et <code>routes.fr.json</code> et associer chacun d&apos;eux dans un ensemble de webconfig param&#xE9;tr&#xE9;s pour faire tourner un site dans diverses langues.</em></p><h3 id="heberger-des-images-polices-css-js-etc">H&#xE9;berger des images, polices, CSS, JS, etc.</h3><p>Vous pouvez &#xE9;galement h&#xE9;berger tout un tas de fichiers sur votre site dans un dossier public. Par exemple avec cette configuration :</p><pre><code class="lang-json">{
    &quot;assetsRelativePath&quot;: &quot;assets&quot;,
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;index.htm&quot;
        }
    }
}
</code></pre><p>et cet ensemble de fichiers :</p><pre><code>&#x251C;&#x2500; assets/
&#x2502;  &#x251C;&#x2500; stylesheets/
&#x2502;  &#x2502;  &#x2514;&#x2500; common.css
&#x2502;  &#x251C;&#x2500; javascripts/
&#x2502;  &#x2502;  &#x2514;&#x2500; common.js
&#x2502;  &#x2514;&#x2500; media/
&#x2502;     &#x2514;&#x2500; images/
&#x2502;        &#x2514;&#x2500; logo.png
&#x251C;&#x2500; views/
&#x2502;  &#x2514;&#x2500; index.htm
&#x2514;&#x2500; webconfig.json
</code></pre><p>vous aurez acc&#xE8;s aux adresses :</p><ul>
<li><em><a href="http://localhost/">http://localhost/</a></em></li>
<li><em><a href="http://localhost/stylesheets/common.css">http://localhost/stylesheets/common.css</a></em></li>
<li><em><a href="http://localhost/javascripts/common.js">http://localhost/javascripts/common.js</a></em></li>
<li><em><a href="http://localhost/media/images/logo.png">http://localhost/media/images/logo.png</a></em></li>
</ul><p><em>Note: si</em> <code>assetsRelativePath</code> <em>n&apos;est pas pr&#xE9;sent dans <code>webconfig.json</code>, par d&#xE9;faut le dossier public est bien</em> <code>assets</code>. <code>assetsRelativePath</code> <em>est donc utile seulement pour changer le nom/chemin du r&#xE9;pertoire.</em></p><h4 id="maxage-etag-etc-">maxAge, Etag, etc.</h4><p>Il est possible de d&#xE9;livrer des en-t&#xEA;te HTTP personnalis&#xE9;es pour les ressources publiques (comme le <code>maxAge</code>, l&apos;<code>Etag</code>, etc.) via la propri&#xE9;t&#xE9; <code>staticOptions</code> du webconfig. Pour conna&#xEE;tre la totalit&#xE9; des possibilit&#xE9;s, voir les options d&apos;<a href="http://expressjs.com/fr/api.html">Express</a>.</p><h3 id="gerer-l-inclusion-de-fichiers-partiels">G&#xE9;rer l&apos;inclusion de fichiers partiels</h3><p>Vous pouvez segmenter vos codes HTML afin de ne pas r&#xE9;p&#xE9;ter le code redondant comme par exemple les parties &#xAB; head &#xBB; et &#xAB; foot &#xBB; ou tout autre fragment de code (pas d&apos;inqui&#xE9;tude, nous verrons plus loin comment g&#xE9;rer un template unique compos&#xE9; des balises <code>head</code> et <code>body</code> avec fermeture dans le m&#xEA;me fichier).</p><p><em>webconfig.json</em></p><pre><code class="lang-json">{
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;index.htm&quot;
        },
        &quot;/liste-des-membres/&quot;: {
            &quot;view&quot;: &quot;members.htm&quot;
        }
    }
}
</code></pre><p>avec les fichiers suivants :</p><pre><code>&#x251C;&#x2500; assets/
&#x2502;  &#x251C;&#x2500; stylesheets/
&#x2502;  &#x2502;  &#x2514;&#x2500; common.css
&#x2502;  &#x2514;&#x2500; javascripts/
&#x2502;     &#x2514;&#x2500; common.js
&#x251C;&#x2500; views/
&#x2502;  &#x251C;&#x2500; partials/
&#x2502;  &#x2502;  &#x251C;&#x2500; head.htm
&#x2502;  &#x2502;  &#x2514;&#x2500; foot.htm
&#x2502;  &#x251C;&#x2500; index.htm
&#x2502;  &#x2514;&#x2500; members.htm
&#x2514;&#x2500; webconfig.json
</code></pre><p><em>views/partials/head.htm</em></p><pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;fr-fr&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot; /&gt;
        &lt;title&gt;Hello world&lt;/title&gt;
        &lt;link type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;stylesheets/common.css&quot; media=&quot;all&quot; /&gt;
    &lt;/head&gt;
    &lt;body&gt;
</code></pre><p><em>views/partials/foot.htm</em></p><pre><code class="lang-html">        &lt;script async type=&quot;text/javascript&quot; src=&quot;javascripts/common.js&quot;&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p><em>views/index.htm</em></p><pre><code class="lang-html">    &lt;?- include(&quot;partials/head.htm&quot;) ?&gt;

    &lt;div&gt;
        &lt;h1&gt;Bienvenue&lt;/h1&gt;
        &lt;p&gt;C&apos;est la page d&apos;accueil.&lt;/p&gt;
    &lt;/div&gt;

    &lt;?- include(&quot;partials/foot.htm&quot;) ?&gt;
</code></pre><p><em>views/members.htm</em></p><pre><code class="lang-html">    &lt;?- include(&quot;partials/head.htm&quot;) ?&gt;

    &lt;div&gt;
        &lt;h1&gt;Liste des members&lt;/h1&gt;
        &lt;p&gt;C&apos;est la page des membres.&lt;/p&gt;
    &lt;/div&gt;

    &lt;?- include(&quot;partials/foot.htm&quot;) ?&gt;
</code></pre><p>vous aurez acc&#xE8;s aux adresses :</p><ul>
<li><em><a href="http://localhost/">http://localhost/</a></em></li>
<li><em><a href="http://localhost/liste-des-membres/">http://localhost/liste-des-membres/</a></em></li>
</ul><p><em>Note: pour plus d&apos;information sur la diff&#xE9;rence entre <code>&lt;?</code>, <code>&lt;?-</code>, <code>&lt;?=</code>, etc. vous pouvez vous r&#xE9;f&#xE9;rez &#xE0; la section <a href="partie-vue-et-template.html#moteur-de-template-ejs">moteur de template</a>.</em></p><h3 id="gerer-des-variations-au-sein-d-une-meme-vue">G&#xE9;rer des variations au sein d&apos;une m&#xEA;me vue</h3><p>Il est possible avec la m&#xEA;me vue et les m&#xEA;mes inclusions de g&#xE9;n&#xE9;rer des pages aux contenus diff&#xE9;rents (utile en mode g&#xE9;n&#xE9;ration de maquettes HTML). Activer les variations avec la configuration suivante :</p><pre><code class="lang-json">{
    &quot;variation&quot;: &quot;common.json&quot;,
    &quot;variationsRelativePath&quot;: &quot;variations&quot;,
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;template.htm&quot;,
            &quot;variation&quot;: &quot;index.json&quot;,
        },
        &quot;/liste-des-membres/&quot;: {
            &quot;view&quot;: &quot;template.htm&quot;,
            &quot;variation&quot;: &quot;members.json&quot;,
        }
    }
}
</code></pre><p>avec les fichiers suivants :</p><pre><code class="lang-txt">&#x251C;&#x2500; assets/
&#x2502;  &#x251C;&#x2500; stylesheets/
&#x2502;  &#x2502;  &#x251C;&#x2500; common.css
&#x2502;  &#x2502;  &#x251C;&#x2500; index.css
&#x2502;  &#x2502;  &#x2514;&#x2500; members.css
&#x2502;  &#x2514;&#x2500; javascripts/
&#x2502;     &#x251C;&#x2500; common.js
&#x2502;     &#x251C;&#x2500; index.js
&#x2502;     &#x2514;&#x2500; members.js
&#x251C;&#x2500; variations/
&#x2502;  &#x251C;&#x2500; common.json
&#x2502;  &#x251C;&#x2500; index.json
&#x2502;  &#x2514;&#x2500; members.json
&#x251C;&#x2500; views/
&#x2502;  &#x251C;&#x2500; partials/
&#x2502;  &#x2502;  &#x251C;&#x2500; head.htm
&#x2502;  &#x2502;  &#x2514;&#x2500; foot.htm
&#x2502;  &#x2514;&#x2500; template.htm
&#x2514;&#x2500; webconfig.json
</code></pre><p><em>variations/common.json</em></p><pre><code class="lang-json">{
    &quot;titleWebsite&quot;: &quot;Titre du site&quot;,
    &quot;classCssCommon&quot;: &quot;common&quot;,
    &quot;classJsCommon&quot;: &quot;common&quot;
}
</code></pre><p><em>variations/index.json</em></p><pre><code class="lang-json">{
    &quot;titlePage&quot;: &quot;Bienvenue&quot;,
    &quot;classPage&quot;: &quot;index&quot;,
    &quot;content&quot;: &quot;&lt;p&gt;C&apos;est la page d&apos;accueil.&lt;/p&gt;&quot;
}
</code></pre><p><em>variations/members.json</em></p><pre><code class="lang-json">{
    &quot;titlePage&quot;: &quot;Liste des membres&quot;,
    &quot;classPage&quot;: &quot;members&quot;,
    &quot;content&quot;: &quot;&lt;p&gt;C&apos;est la page des membres.&lt;/p&gt;&quot;
}
</code></pre><p><em>views/partials/head.htm</em></p><pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;fr-fr&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot; /&gt;
        &lt;title&gt;&lt;?- specific.titlePage ?&gt;&lt;/title&gt;

        &lt;link type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;stylesheets/&lt;?= common.classCssCommon ?&gt;.css&quot; media=&quot;all&quot; /&gt;
        &lt;link type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;stylesheets/&lt;?= specific.classPage ?&gt;.css&quot; media=&quot;all&quot; /&gt;
    &lt;/head&gt;
    &lt;body class=&quot;&lt;?= specific.classPage ?&gt;&quot;&gt;
</code></pre><p><em>views/partials/foot.htm</em></p><pre><code class="lang-html">        &lt;script async type=&quot;text/javascript&quot; src=&quot;javascripts/&lt;?= common.classJsCommon ?&gt;.js&quot;&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p><em>views/template.htm</em></p><pre><code class="lang-html">    &lt;?- include(&quot;partials/head.htm&quot;) ?&gt;

    &lt;div class=&quot;title&quot;&gt;&lt;?- common.titleWebsite ?&gt;&lt;/div&gt;

    &lt;div&gt;
        &lt;h1&gt;&lt;?- specific.titlePage ?&gt;&lt;/h1&gt;
        &lt;?- specific.content ?&gt;
    &lt;/div&gt;

    &lt;?- include(&quot;partials/foot.htm&quot;) ?&gt;
</code></pre><p>vous aurez acc&#xE8;s aux adresses :</p><ul>
<li><em><a href="http://localhost/">http://localhost/</a></em></li>
<li><em><a href="http://localhost/liste-des-membres/">http://localhost/liste-des-membres/</a></em></li>
</ul><p><em>Note: si</em> <code>variationsRelativePath</code> <em>n&apos;est pas pr&#xE9;sent dans <code>webconfig.json</code>, par d&#xE9;faut le dossier des variations est bien</em> <code>variations</code>. <code>variationsRelativePath</code> <em>est donc utile seulement pour changer le nom/chemin de r&#xE9;pertoire.</em></p><h3 id="gerer-l-internationalisation-i18n">G&#xE9;rer l&apos;internationalisation (i18n)</h3><h4 id="toutes-les-langues-sur-le-m-me-site">Toutes les langues sur le m&#xEA;me site</h4><p>Sur le m&#xEA;me principe, les variations peuvent &#xEA;tre utilis&#xE9;es pour cr&#xE9;er la m&#xEA;me page, mais dans des langues diff&#xE9;rentes (et derri&#xE8;re des routes diff&#xE9;rentes) :</p><pre><code class="lang-json">{
    &quot;languageCode&quot;: &quot;en-us&quot;,
    &quot;variationsRelativePath&quot;: &quot;l10n&quot;,
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;landing.htm&quot;,
            &quot;variation&quot;: &quot;landing.json&quot;
        },
        &quot;/home/&quot;: {
            &quot;view&quot;: &quot;home.htm&quot;,
            &quot;variation&quot;: &quot;home.json&quot;
        },
        &quot;/accueil/&quot;: {
            &quot;view&quot;: &quot;home.htm&quot;,
            &quot;variation&quot;: &quot;home.json&quot;,
            &quot;languageCode&quot;: &quot;fr-fr&quot;
        }
    }
}
</code></pre><p><em>Note: dans cet exemple, je n&apos;utilise pas la propri&#xE9;t&#xE9; <code>variation</code> commune car je n&apos;utilise pas de</em> <code>common.json</code> <em>. J&apos;ai arbitrairement d&#xE9;cid&#xE9; de renommer mon dossier</em> <code>variations</code> <em>en</em> <code>l10n</code> <em>(localisation)</em>.</p><p>avec les fichiers suivants :</p><pre><code>&#x251C;&#x2500; l10n/
&#x2502;  &#x251C;&#x2500; landing.json
&#x2502;  &#x251C;&#x2500; en-us
&#x2502;  &#x2502;  &#x2514;&#x2500; home.json
&#x2502;  &#x2514;&#x2500; fr-fr
&#x2502;     &#x2514;&#x2500; home.json
&#x251C;&#x2500; views/
&#x2502;  &#x251C;&#x2500; partials/
&#x2502;  &#x2502;  &#x251C;&#x2500; head.htm
&#x2502;  &#x2502;  &#x2514;&#x2500; foot.htm
&#x2502;  &#x251C;&#x2500; landing.htm
&#x2502;  &#x2514;&#x2500; home.htm
&#x2514;&#x2500; webconfig.json
</code></pre><p><em>l10n/landing.json</em></p><pre><code class="lang-json">{
    &quot;titlePage&quot;: &quot;Landing&quot;,
    &quot;classPage&quot;: &quot;landing&quot;,
    &quot;selectLabel&quot;: [
        &quot;English&quot;,
        &quot;Fran&#xE7;ais&quot;
    ]
}
</code></pre><p><em>l10n/en-us/home.json</em></p><pre><code class="lang-json">{
    &quot;titlePage&quot;: &quot;Welcome&quot;,
    &quot;classPage&quot;: &quot;home&quot;,
    &quot;content&quot;: &quot;&lt;p&gt;This is a home page.&lt;/p&gt;&quot;
}
</code></pre><p><em>l10n/fr-fr/home.json</em></p><pre><code class="lang-json">{
    &quot;titlePage&quot;: &quot;Bienvenue&quot;,
    &quot;classPage&quot;: &quot;home&quot;,
    &quot;content&quot;: &quot;&lt;p&gt;C&apos;est la page d&apos;accueil.&lt;/p&gt;&quot;
}
</code></pre><p><em>views/partials/head.htm</em></p><pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;&lt;?= languageCode ?&gt;&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot; /&gt;
        &lt;title&gt;&lt;?= specific.titlePage ?&gt;&lt;/title&gt;
    &lt;/head&gt;
    &lt;body class=&quot;&lt;?= specific.classPage ?&gt;&quot;&gt;
</code></pre><p><em>views/partials/foot.htm</em></p><pre><code class="lang-html">    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p><em>views/landing.htm</em></p><pre><code class="lang-html">    &lt;?- include(&quot;partials/head.htm&quot;) ?&gt;

    &lt;select&gt;
        &lt;? for (var i = 0; i &lt; specific.selectLabel.length; i++) { ?&gt;
        &lt;option&gt;&lt;?= specific.selectLabel[i] ?&gt;&lt;/option&gt;
        &lt;? } ?&gt;
    &lt;/select&gt;

    &lt;?- include(&quot;partials/foot.htm&quot;) ?&gt;
</code></pre><p><em>views/home.htm</em></p><pre><code class="lang-html">    &lt;?- include(&quot;partials/head.htm&quot;) ?&gt;

    &lt;div&gt;
        &lt;h1&gt;&lt;?- specific.titlePage ?&gt;&lt;/h1&gt;
        &lt;?- specific.content ?&gt;
    &lt;/div&gt;

    &lt;?- include(&quot;partials/foot.htm&quot;) ?&gt;
</code></pre><p>vous aurez acc&#xE8;s aux adresses :</p><ul>
<li><em><a href="http://localhost/">http://localhost/</a></em></li>
<li><em><a href="http://localhost/home/">http://localhost/home/</a></em></li>
<li><em><a href="http://localhost/accueil/">http://localhost/accueil/</a></em></li>
</ul><p><em>Note : par d&#xE9;faut c&apos;est le</em> <code>languageCode</code> <em>racine qui conditionne la langue d&apos;affichage du site. Il est aussi possible de changer la langue avec un</em> <code>languageCode</code> par page. <em>Il faut &#xE9;galement savoir que d&#xE8;s que le site ou une page &#xE0; un</em> <code>languageCode</code> <em>dans la configuration, ses fichiers de variations doivent &#xEA;tre plac&#xE9;es dans un sous r&#xE9;pertoire portant le nom du</em> <code>languageCode</code>.</p><h4 id="utiliser-variations-et-localisations-ensemble">Utiliser variations et localisations ensemble</h4><p>Vous avez peut-&#xEA;tre constat&#xE9; dans l&apos;exemple pr&#xE9;c&#xE9;dent que le fichier <code>landing.json</code> n&apos;&#xE9;tait pas dans le dossier <code>en-us/</code> ou <code>fr-fr/</code>. Cela est tout &#xE0; fait possible et signifie qu&apos;il sera utilis&#xE9; dans les langues qui ne le poss&#xE8;dent pas dans leur dossier.</p><p>Aussi, quand un <code>languageCode</code> est pr&#xE9;cis&#xE9;, NodeAtlas part d&apos;abord chercher la valeur dans le fichier du dossier correspondant. Si celle-ci n&apos;y est pas, alors il part la chercher dans le dossier parent (celui utilis&#xE9; en standard pour les variations sans localisation).</p><p>Cela va vous permettre par exemple de g&#xE9;rer la langue ma&#xEE;tre directement dans le dossier de variation. Ainsi avec l&apos;exemple suivant :</p><pre><code>&#x250A;&#x2509;
&#x251C;&#x2500; variations/
&#x2502;  &#x251C;&#x2500; common.json
&#x2502;  &#x251C;&#x2500; home.json
&#x2502;  &#x2514;&#x2500; fr-fr
&#x2502;     &#x251C;&#x2500; common.json
&#x2502;     &#x2514;&#x2500; home.json
&#x250A;&#x2509;
</code></pre><p>vous pouvez</p><ul>
<li>g&#xE9;rer la version <code>en-us</code> directement &#xE0; la racine de <code>variations/</code> (comme NodeAtlas ne trouve rien dans <code>en-us</code> il utilise alors les valeurs des fichiers racines) et</li>
<li>g&#xE9;rer la version <code>fr-fr</code> dans le dossier <code>fr-fr/</code>,</li>
</ul><p>ainsi, si une phrase n&apos;est pas encore traduite dans un fichier <code>fr-fr</code>, au lieu de renvoyer une erreur, NodeAtlas renverra la version racine, soit la version <code>en-us</code>.</p><h4 id="-chaque-langue-sa-configuration">&#xC0; chaque langue sa configuration</h4><p>Vous pouvez &#xE9;galement d&#xE9;cider de faire tourner chaque langue dans un &#xAB; webconfig.json &#xBB; diff&#xE9;rent. Avec l&apos;ensemble de fichier suivant :</p><pre><code>&#x251C;&#x2500; variations/
&#x2502;  &#x251C;&#x2500; landing.json
&#x2502;  &#x251C;&#x2500; en-us
&#x2502;  &#x2502;  &#x251C;&#x2500; home.json
&#x2502;  &#x2502;  &#x2514;&#x2500; members.json
&#x2502;  &#x2514;&#x2500; fr-fr
&#x2502;     &#x251C;&#x2500; home.json
&#x2502;     &#x2514;&#x2500; members.json
&#x251C;&#x2500; views/
&#x2502;  &#x251C;&#x2500; partials/
&#x2502;  &#x2502;  &#x251C;&#x2500; head.htm
&#x2502;  &#x2502;  &#x2514;&#x2500; foot.htm
&#x2502;  &#x251C;&#x2500; landing.htm
&#x2502;  &#x251C;&#x2500; home.htm
&#x2502;  &#x2514;&#x2500; members.htm
&#x251C;&#x2500; webconfig.json
&#x251C;&#x2500; webconfig.en-us.json
&#x2514;&#x2500; webconfig.fr-fr.json
</code></pre><p>vous pourriez avoir les &#xAB; webconfig.json &#xBB; suivant :</p><p><em>webconfig.json</em></p><pre><code class="lang-json">{
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;landing.htm&quot;,
            &quot;variation&quot;: &quot;landing.json&quot;
        }
    }
}
</code></pre><p><em>webconfig.en-us.json</em></p><pre><code class="lang-json">{
    &quot;httpPort&quot;: 81,
    &quot;urlRelativeSubPath&quot;: &quot;english&quot;,
    &quot;languageCode&quot;: &quot;en-us&quot;,
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;home.htm&quot;,
            &quot;variation&quot;: &quot;home.json&quot;
        },
        &quot;/members-list/&quot;: {
            &quot;view&quot;: &quot;members.htm&quot;,
            &quot;variation&quot;: &quot;members.json&quot;
        }
    }
}
</code></pre><p><em>webconfig.fr-fr.json</em></p><pre><code class="lang-json">{
    &quot;httpPort&quot;: 82,
    &quot;urlRelativeSubPath&quot;: &quot;francais&quot;,
    &quot;languageCode&quot;: &quot;fr-fr&quot;,
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;home.htm&quot;,
            &quot;variation&quot;: &quot;home.json&quot;
        },
        &quot;/liste-des-membres/&quot;: {
            &quot;view&quot;: &quot;members.htm&quot;,
            &quot;variation&quot;: &quot;members.json&quot;
        }
    }
}
</code></pre><p>et avoir acc&#xE8;s aux adresses :</p><ul>
<li><em><a href="http://localhost/">http://localhost/</a></em></li>
<li><em><a href="http://localhost:81/english/">http://localhost:81/english/</a></em></li>
<li><em><a href="http://localhost:81/english/">http://localhost:81/english/</a></em></li>
<li><em><a href="http://localhost:81/english/members-list/">http://localhost:81/english/members-list/</a></em></li>
<li><em><a href="http://localhost:82/francais/">http://localhost:82/francais/</a></em></li>
<li><em><a href="http://localhost:82/francais/liste-des-membres/">http://localhost:82/francais/liste-des-membres/</a></em></li>
</ul><p>Il est ensuite possible de faire du reverse proxy avec pour ramener l&apos;ensemble des URLs sur le port 80 afin d&apos;obtenir :</p><ul>
<li><em><a href="http://www.website.ext/">http://www.website.ext/</a></em></li>
<li><em><a href="http://www.website.ext/english/">http://www.website.ext/english/</a></em></li>
<li><em><a href="http://www.website.ext/english/">http://www.website.ext/english/</a></em></li>
<li><em><a href="http://www.website.ext/english/members-list/">http://www.website.ext/english/members-list/</a></em></li>
<li><em><a href="http://www.website.ext/francais/">http://www.website.ext/francais/</a></em></li>
<li><em><a href="http://www.website.ext/francais/liste-des-membres/">http://www.website.ext/francais/liste-des-membres/</a></em></li>
</ul><h3 id="gerer-l-anatomie-des-urls">G&#xE9;rer l&apos;anatomie des URLs</h3><p>Par d&#xE9;faut, si vous utilisez la configuration suivante :</p><p><em>webconfig.json</em></p><pre><code class="lang-json">{
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;index.htm&quot;
        }
    }
}
</code></pre><p>avec la vue suivante :</p><p><em>views/index.htm</em></p><pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;fr-fr&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot; /&gt;
        &lt;title&gt;URLs&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div&gt;&lt;?- urlRootPath ?&gt;&lt;/div&gt;
        &lt;div&gt;&lt;?- urlSubPath ?&gt;&lt;/div&gt;
        &lt;div&gt;&lt;?- urlBasePath ?&gt;&lt;/div&gt;
        &lt;div&gt;&lt;?- urlFilePath ?&gt;&lt;/div&gt;
        &lt;div&gt;&lt;?- urlQueryPath ?&gt;&lt;/div&gt;
        &lt;div&gt;&lt;?- urlPath ?&gt;&lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p>cela est identique &#xE0; utiliser celle-ci :</p><p><em>webconfig.json</em></p><pre><code class="lang-json">{
    &quot;httpHostname&quot;: &quot;localhost&quot;,
    &quot;httpPort&quot;: 80,
    &quot;httpSecure&quot;: false,
    &quot;urlRelativeSubPath&quot;: &quot;&quot;,
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;index.htm&quot;
        }
    }
}
</code></pre><p>Vous pourrez acc&#xE9;der &#xE0; l&apos;URL : <em><a href="http://localhost/">http://localhost/</a></em> et au contenu :</p><pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;fr-fr&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot; /&gt;
        &lt;title&gt;URLs&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div&gt;http://localhost&lt;/div&gt;
        &lt;div&gt;&lt;/div&gt;
        &lt;div&gt;http://localhost&lt;/div&gt;
        &lt;div&gt;/&lt;/div&gt;
        &lt;div&gt;&lt;/div&gt;
        &lt;div&gt;http://localhost/&lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p>Changez alors la configuration en ceci :</p><pre><code class="lang-json">{
    &quot;httpHostname&quot;: &quot;127.0.0.1&quot;,
    &quot;httpPort&quot;: 7777,
    &quot;httpSecure&quot;: &quot;security/server&quot;,
    &quot;urlRelativeSubPath&quot;: &quot;sub/folder&quot;,
    &quot;routes&quot;: {
        &quot;/index.html&quot;: {
            &quot;view&quot;: &quot;index.htm&quot;
        }
    }
}
</code></pre><p>Vous pourrez cette fois acc&#xE9;der &#xE0; l&apos;URL : <em><a href="https://127.0.0.1:7777/sub/folder/index.html?test=ok">https://127.0.0.1:7777/sub/folder/index.html?test=ok</a></em> et au contenu :</p><pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;fr-fr&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot; /&gt;
        &lt;title&gt;URLs&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div&gt;https://127.0.0.1:7777&lt;/div&gt;
        &lt;div&gt;/sub/folder&lt;/div&gt;
        &lt;div&gt;https://127.0.0.1:7777/sub/folder&lt;/div&gt;
        &lt;div&gt;/index.html&lt;/div&gt;
        &lt;div&gt;?test=ok&lt;/div&gt;
        &lt;div&gt;https://127.0.0.1:7777/sub/folder/index.html&lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p>Note : cette exemple ne fonctionnera que si vous avez des fichiers <code>server.crt</code> et <code>server.key</code> valide dans le dossier <code>security/</code>. Essayez le sans <code>&quot;httpSecure&quot;: &quot;security/server&quot;</code> et il fonctionnera avec des URLs sans <code>https</code>.</p><h3 id="creer-ses-propres-variables-de-webconfig">Cr&#xE9;er ses propres variables de webconfig</h3><p>Imaginons deux webconfigs dans lesquels nous allons cr&#xE9;er nos propres variables comme suit :</p><ol>
<li>&#xAB; webconfig.json &#xBB;</li>
</ol><pre><code class="lang-json">{
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;index.htm&quot;
        }
    },
    &quot;_minified&quot;: &quot;&quot;
}
</code></pre><ol>
<li>&#xAB; webconfig.prod.json &#xBB;</li>
</ol><pre><code class="lang-json">{
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;index.htm&quot;
        }
    },
    &quot;_minified&quot;: &quot;.min&quot;
}
</code></pre><p>avec cet ensemble de fichiers</p><pre><code>&#x251C;&#x2500; assets/
&#x2502;  &#x251C;&#x2500; stylesheets/
&#x2502;  &#x2502;  &#x251C;&#x2500; common.css
&#x2502;  &#x2502;  &#x2514;&#x2500; common.min.css
&#x2502;  &#x2514;&#x2500; javascripts/
&#x2502;     &#x251C;&#x2500; common.js
&#x2502;     &#x2514;&#x2500; common.min.js
&#x251C;&#x2500; views/
&#x2502;  &#x2514;&#x2500; index.htm
&#x251C;&#x2500; webconfig.json
&#x2514;&#x2500; webconfig.prod.json
</code></pre><p>et &#xAB; index.htm &#xBB; contenant :</p><pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;fr-fr&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot; /&gt;
        &lt;title&gt;Hello world&lt;/title&gt;
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;stylesheets/common&lt;?= webconfig._minified ?&gt;.css&quot; /&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div&gt;Ceci est un test de r&#xE9;cup&#xE9;ration de ressources minifi&#xE9;es/non-minifi&#xE9;es.&lt;/div&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;javascripts/common&lt;?= webconfig._minified ?&gt;.js&quot;&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p>En lan&#xE7;ant (depuis le dossier du site) la commande :</p><pre><code class="lang-bash">$ node-atlas
</code></pre><p>Nous aurons &#xE0; l&apos;adresse &#xAB; <a href="http://localhost/">http://localhost/</a> &#xBB; la sortie suivante avec les fichiers non minifi&#xE9;s :</p><pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;fr-fr&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot; /&gt;
        &lt;title&gt;Hello world&lt;/title&gt;
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;stylesheets/common.css&quot; /&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div&gt;Ceci est un test de r&#xE9;cup&#xE9;ration de ressources minifi&#xE9;es/non-minifi&#xE9;es.&lt;/div&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;javascripts/common.js&quot;&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p>Cependant en lan&#xE7;ant la commande :</p><pre><code class="lang-bash">$ node-atlas --webconfig webconfig.prod.json
</code></pre><p>Nous aurons &#xE0; l&apos;adresse &#xAB; <a href="http://localhost/">http://localhost/</a> &#xBB; la sortie suivante avec les fichiers minifi&#xE9;s :</p><pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;fr-fr&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot; /&gt;
        &lt;title&gt;Hello world&lt;/title&gt;
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;stylesheets/common.min.css&quot; /&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div&gt;Ceci est un test de r&#xE9;cup&#xE9;ration de ressources minifi&#xE9;es/non-minifi&#xE9;es.&lt;/div&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;javascripts/common.min.js&quot;&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p><em>Note : il vaut mieux pr&#xE9;fixer ses variables personnelles avec &#xAB; _ &#xBB; pour &#xE9;viter des conflits avec des variables de configuration existantes ou futures.</em></p><h3 id="utiliser-une-vue-globale">Utiliser une vue globale</h3><p>Plut&#xF4;t que d&apos;inclure une partie header et une partie footer en deux fichiers scind&#xE9; dont les balises de l&apos;un ne se ferme que dans les balises de l&apos;autre : vous pouvez &#xE9;galement les rassembler dans un seul fichier dans lequel vous indiquerez &#xE0; quelle endroit les vues doivent se placer. Vous pourrez dans ce layout utiliser toutes les variations et tous les syst&#xE8;mes d&#xE9;j&#xE0; vu.</p><p>avec cet ensemble de fichiers</p><pre><code>&#x251C;&#x2500; assets/
&#x2502;  &#x251C;&#x2500; stylesheets/
&#x2502;  &#x2502;  &#x251C;&#x2500; common.css
&#x2502;  &#x2502;  &#x2514;&#x2500; index.css
&#x2502;  &#x2514;&#x2500; javascripts/
&#x2502;     &#x2514;&#x2500; common.js
&#x251C;&#x2500; variations/
&#x2502;  &#x251C;&#x2500; common.json
&#x2502;  &#x2514;&#x2500; index.json
&#x251C;&#x2500; views/
&#x2502;  &#x251C;&#x2500; partials/
&#x2502;  &#x2502;  &#x2514;&#x2500; header.htm
&#x2502;  &#x251C;&#x2500; about.htm
&#x2502;  &#x251C;&#x2500; common.htm
&#x2502;  &#x2514;&#x2500; index.htm
&#x2514;&#x2500; webconfig.json
</code></pre><p>et avec le webconfig suivant :</p><p><em>webconfig.json</em></p><pre><code class="lang-json">{
    &quot;view&quot;: &quot;common.htm&quot;,
    &quot;variation&quot;: &quot;common.json&quot;,
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;index.htm&quot;,
            &quot;variation&quot;: &quot;index.json&quot;
        },
        &quot;/a-propos/&quot;: {
            &quot;view&quot;: &quot;about.htm&quot;
        }
    }
}
</code></pre><p>et ces deux fichiers de variations :</p><p><em>common.json</em></p><pre><code class="lang-json">{
    &quot;titleWebsite&quot;: &quot;Titre du site&quot;,
    &quot;classCssCommon&quot;: &quot;common&quot;,
    &quot;classJsCommon&quot;: &quot;common&quot;
}
</code></pre><p><em>index.json</em></p><pre><code class="lang-json">{
    &quot;titlePage&quot;: &quot;Bienvenue&quot;,
    &quot;classPage&quot;: &quot;index&quot;,
    &quot;content&quot;: &quot;&lt;p&gt;C&apos;est la page d&apos;accueil.&lt;/p&gt;&quot;
}
</code></pre><p>vous pourez g&#xE9;n&#xE9;rer avec ces vues :</p><p><em>views/common.htm</em></p><pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;fr-fr&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot;&gt;
        &lt;title&gt;&lt;?- specific.titlePage || &quot;Pas de titre&quot; ?&gt;&lt;/title&gt;
        &lt;link rel=&quot;stylesheet&quot; href=&quot;stylesheets/&lt;?= common.classCssCommon ?&gt;.css&quot;  media=&quot;all&quot;&gt;
        &lt;? if (specific.classPage) { ?&gt;
        &lt;link rel=&quot;stylesheet&quot; href=&quot;stylesheets/&lt;?= specific.classPage ?&gt;.css&quot;  media=&quot;all&quot;&gt;
        &lt;? } ?&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;!-- Inclure un fichier normalement --&gt;
        &lt;?- include(&quot;partials/header.htm&quot;) ?&gt;

        &lt;!-- Inclure le fichier vu de `view` --&gt;
        &lt;?- include(routeParameters.view) ?&gt;

        &lt;script async=&quot;true&quot; type=&quot;text/javascript&quot; src=&quot;javascripts/&lt;?= common.classJsCommon ?&gt;.js&quot;&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p><em>views/partals/header.htm</em></p><pre><code class="lang-html">    &lt;header&gt;
        &lt;h1&gt;&lt;?= specific.titlePage ?&gt;&lt;/h1&gt;
    &lt;/header&gt;
</code></pre><p><em>views/index.htm</em></p><pre><code class="lang-html">    &lt;div&gt;
        &lt;?- specific.content ?&gt;
    &lt;/div&gt;
</code></pre><p><em>views/about.htm</em></p><pre><code class="lang-html">    &lt;div&gt;
        &lt;h1&gt;NodeAtlas &#xA9; Haeresis&lt;/h1&gt;
    &lt;/div&gt;
</code></pre><p>et obtenir les URL suivantes :</p><p><em>/</em></p><pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;fr-fr&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot;&gt;
        &lt;title&gt;Bienvenue&lt;/title&gt;
        &lt;link rel=&quot;stylesheet&quot; href=&quot;stylesheets/common.css&quot;  media=&quot;all&quot;&gt;
        &lt;link rel=&quot;stylesheet&quot; href=&quot;stylesheets/index.css&quot;  media=&quot;all&quot;&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;header&gt;
            &lt;h1&gt;Bienvenue&lt;/h1&gt;
        &lt;/header&gt;
        &lt;div&gt;
            &lt;p&gt;C&apos;est la page d&apos;accueil.&lt;/p&gt;
        &lt;/div&gt;
        &lt;script async=&quot;true&quot; type=&quot;text/javascript&quot; src=&quot;javascripts/common.js&quot;&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p><em>/about/</em></p><pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;fr-fr&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot;&gt;
        &lt;title&gt;Pas de titre&lt;/title&gt;
        &lt;link rel=&quot;stylesheet&quot; href=&quot;stylesheets/common.css&quot;  media=&quot;all&quot;&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div&gt;
            &lt;h1&gt;NodeAtlas &#xA9; Haeresis&lt;/h1&gt;
        &lt;/div&gt;
        &lt;script async=&quot;true&quot; type=&quot;text/javascript&quot; src=&quot;javascripts/common.js&quot;&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><h3 id="partager-des-dossiers">Partager des dossiers</h3><p>Il est possible de partager plus de contenu que ce qu&apos;il y a dans le dossier h&#xE9;berg&#xE9; par <code>assetsRelativePath</code>. Il est tout &#xE0; fait possible de partager des vues ou des mod&#xE8;les avec la partie cliente par exemple. On appel les fichiers de ses dossiers des fichiers statiques.</p><p>Voyons l&apos;exemple suivant :</p><p>avec cet ensemble de fichiers</p><pre><code>&#x251C;&#x2500; models/
&#x2502;  &#x2514;&#x2500; user.js
&#x251C;&#x2500; views/
&#x2502;  &#x2514;&#x2500; index.htm
&#x2514;&#x2500; webconfig.json
</code></pre><p><em>webconfig.json</em></p><pre><code class="lang-json">{
    &quot;statics&quot;: {
        &quot;/javascripts/models&quot;: &quot;models&quot;
    },
    &quot;routes&quot;: {
        &quot;/&quot;: &quot;index.htm&quot;
    }
}
</code></pre><p><em>views/index.htm</em></p><pre><code class="lang-html">&lt;!DOCTYPE html&gt;
    &lt;html lang=&quot;fr-fr&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot;&gt;
        &lt;title&gt;Statics&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id=&quot;user&quot;&gt;&lt;/div&gt;
        &lt;script src=&quot;javascripts/models/user.js&quot;&gt;&lt;/script&gt;
        &lt;script&gt;
            var user = new User(),
                mount = document.getElementById(&quot;user&quot;);

            user
                .firstname(&quot;Bruno&quot;)
                .lastname(&quot;Lesieur&quot;);

            mount.innerHTML = user.firstname() + &quot; &quot; + user.lastname();
        &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p><em>models/user.js</em></p><pre><code class="lang-js">(function (expose, factory) {
    if (typeof module !== &apos;undefined&apos; &amp;&amp; module.exports) {
        module.exports = factory;
    } else {
        expose.User = factory;
    }
}(this, function User() {
    var privates = {},
        publics = this;

    publics.lastname = function (lastname) {
        if (typeof lastname === &apos;undefined&apos;) {
            return privates.lastname;
        } else {
            privates.lastname = lastname;
            return publics;
        }
    };

    publics.firstname = function (firstname) {
        if (typeof firstname === &apos;undefined&apos;) {
            return privates.firstname;
        } else {
            privates.firstname = firstname;
            return publics;
        }
    };
}));
</code></pre><p>Nous pourrons acc&#xE9;der aux fichiers HTML <code>http://localhost/</code> et au JavaScript <code>http://localhost/javascripts/user.js</code>.</p><h4 id="maxage-etag-etc-">maxAge, Etag, etc.</h4><p>Il est possible de configurer les informations livr&#xE9;es par NodeAtlas &#xE0; la demande d&apos;une ressource statique (comme le <code>maxAge</code>, l&apos;<code>Etag</code>, etc.) via la propri&#xE9;t&#xE9; <code>staticOptions</code>. Dans ce cas, on ne fournit plus une <code>string</code> mais un <code>Object</code> et la propri&#xE9;t&#xE9; initiale devient le param&#xE8;tre <code>path</code>. Par d&#xE9;faut les <code>staticOptions</code> sont celle global au webconfig (voir les options d&apos;<a href="http://expressjs.com/fr/api.html">Express</a>).</p><pre><code class="lang-json">{
    &quot;statics&quot;: {
        &quot;/javascripts/models&quot;: {
            &quot;path&quot;: &quot;models&quot;,
            &quot;staticOptions&quot;: {
                &quot;index&quot;: false
            }
        }
    },
    &quot;routes&quot;: {
        &quot;/&quot;: &quot;index.htm&quot;
    }
}
</code></pre><h4 id="ordonner-les-routes">Ordonner les routes</h4><p>Il est &#xE9;galement possible de placer ses routes dans un tableau, ce qui permettra de les prioriser lors de leur manipulation ult&#xE9;rieur dans la section des contr&#xF4;leurs.</p><p>Dans ce cas le chemin devient le param&#xE8;tre <code>virtual</code>.</p><pre><code class="lang-json">{
    &quot;statics&quot;: [{
        &quot;virtual&quot;: &quot;/javascripts/models&quot;,
        &quot;path&quot;: &quot;models&quot;,
        &quot;staticOptions&quot;: {
            &quot;index&quot;: false
        }
    }],
    &quot;routes&quot;: {
        &quot;/&quot;: &quot;index.htm&quot;
    }
}
</code></pre><h3 id="generer-des-maquettes-html">G&#xE9;n&#xE9;rer des maquettes HTML</h3><h4 id="g-n-rer-des-designs-html">G&#xE9;n&#xE9;rer des designs HTML</h4><p>Avec la configuration suivante il est possible de g&#xE9;n&#xE9;rer des aper&#xE7;u HTML du rendu de chaque page dans un fichier associ&#xE9;. Le fichier sera (re)cr&#xE9;&#xE9; &#xE0; chaque affichage de la page dans votre navigateur.</p><pre><code class="lang-json">{
    &quot;htmlGenerationBeforeResponse&quot;: true,
    &quot;assetsRelativePath&quot;: &quot;../HTML/&quot;,
    &quot;serverlessRelativePath&quot;: &quot;../HTML/&quot;,
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;index.htm&quot;,
            &quot;output&quot;: &quot;/index.html&quot;
        },
        &quot;/liste-des-membres/&quot;: {
            &quot;view&quot;: &quot;members.htm&quot;,
            &quot;output&quot;: &quot;/membres/liste.html&quot;
        },
        &quot;/liste-des-membres/?foo=bar&quot;: {
            &quot;view&quot;: &quot;members.htm&quot;,
            &quot;output&quot;: false
        },
        &quot;/aucun/parametre/output/&quot;: {
            &quot;view&quot;: &quot;members.htm&quot;
        }
    }
}
</code></pre><p>et l&apos;ensemble de fichiers suivant :</p><pre><code>&#x251C;&#x2500; HTML/
&#x2502;  &#x251C;&#x2500; stylesheets/
&#x2502;  &#x2502;  &#x251C;&#x2500; common.css
&#x2502;  &#x2514;&#x2500; javascripts/
&#x2502;     &#x2514;&#x2500; common.js
&#x251C;&#x2500; views/
&#x2502;  &#x251C;&#x2500; index.htm
&#x2502;  &#x2514;&#x2500; members.htm
&#x2514;&#x2500; webconfig.json
</code></pre><p>on peut cr&#xE9;er physiquement la sortie suivante :</p><pre><code>&#x251C;&#x2500; HTML/
&#x2502;  &#x251C;&#x2500; stylesheets/
&#x2502;  &#x2502;  &#x2514;&#x2500; common.css
&#x2502;  &#x251C;&#x2500; javascripts/
&#x2502;  &#x2502;  &#x2514;&#x2500; common.js
&#x2502;  &#x251C;&#x2500; index.html
&#x2502;  &#x251C;&#x2500; members/
&#x2502;  &#x2502;  &#x2514;&#x2500; list.html
&#x2502;  &#x2514;&#x2500; aucun/
&#x2502;     &#x2514;&#x2500; parametre/
&#x2502;        &#x2514;&#x2500; output &#x2906; Ceci est un fichier
&#x251C;&#x2500; views/
&#x2502;  &#x250A;&#x2509;
&#x2514;&#x2500; webconfig.json
</code></pre><p>en se rendant aux adresses :</p><ul>
<li><em><a href="http://localhost/">http://localhost/</a></em></li>
<li><em><a href="http://localhost/liste-des-membres/">http://localhost/liste-des-membres/</a></em></li>
<li><em><a href="http://localhost/parametre/output/">http://localhost/parametre/output/</a></em></li>
</ul><p><em>Note : Il n&apos;y a pas de g&#xE9;n&#xE9;ration pour &#xAB; /liste-des-membres/?foo=bar &#xBB; car <code>output</code> est &#xE0; <code>false</code>. Utilisez cette valeur pour ignorer des routes &#xE0; la g&#xE9;n&#xE9;ration.</em></p><p>La g&#xE9;n&#xE9;ration s&apos;enclenche quand on affiche la page uniquement parce que <code>htmlGenerationBeforeResponse</code> existe et est &#xE0; <code>true</code>.</p><h4 id="g-n-rer-un-site-sans-partie-serveur">G&#xE9;n&#xE9;rer un site sans partie serveur</h4><p>Il est &#xE9;galement possible de g&#xE9;rer la cr&#xE9;ation d&apos;un site en simple page HTML avec la commande <code>--generate</code>.</p><p>Si <code>htmlGenerationBeforeResponse</code> est pass&#xE9; &#xE0; <code>false</code> (ou enlev&#xE9;) le seul moyen de g&#xE9;n&#xE9;rer toutes les pages du site sera via la commande <code>node-atlas --generate</code> qui g&#xE9;n&#xE8;rera toutes les pages d&apos;un coup dans le dossier <code>serverlessRelativePath</code> &#xE0; la condition que le <code>output</code> global soit &#xE0; <code>true</code>.</p><p>De plus avec <code>--generate</code>, l&apos;int&#xE9;gralit&#xE9; du dossier <code>assetsRelativePath</code> (dossier des fichiers publics) sera copi&#xE9; dans le dossier <code>serverlessRelativePath</code> si les deux dossiers n&apos;ont pas un chemin identique &#xE0; condition que <code>assetsCopy</code> soit &#xE0; <code>true</code>.</p><p>Cela vous permet r&#xE9;ellement d&apos;obtenir en sortie dans le dossier de g&#xE9;n&#xE9;ration des pages &#xAB; stand-alone &#xBB; avec l&apos;int&#xE9;gralit&#xE9; des fichiers auxquels elles font appel (CSS / JS / Images, etc.).</p><p>Voyons cela avec la configuration suivante :</p><pre><code class="lang-json">{
    &quot;output&quot;: true,
    &quot;assetsCopy&quot;: true,
    &quot;languageCode&quot;: &quot;fr-fr&quot;,
    &quot;index&quot;: true,
    &quot;serverlessRelativePath&quot;: &quot;serverless&quot;,
    &quot;routes&quot;: {
        &quot;/cv.html&quot;: {
            &quot;view&quot;: &quot;index.htm&quot;,
            &quot;variation&quot;: &quot;index.json&quot;
        },
        &quot;/en/cv.html&quot;: {
            &quot;view&quot;: &quot;index.htm&quot;,
            &quot;variation&quot;: &quot;index.json&quot;,
            &quot;languageCode&quot;: &quot;en&quot;
        }
    }
}
</code></pre><p>et l&apos;ensemble de fichiers suivant :</p><pre><code>&#x251C;&#x2500; assets/
&#x2502;  &#x251C;&#x2500; stylesheets/
&#x2502;  &#x2502;  &#x2514;&#x2500; common.css
&#x2502;  &#x2514;&#x2500; javascripts/
&#x2502;     &#x2514;&#x2500; common.js
&#x251C;&#x2500; variations/
&#x2502;  &#x251C;&#x2500; fr-fr/
&#x2502;  &#x2502;  &#x2514;&#x2500; index.json
&#x2502;  &#x2514;&#x2500; en/
&#x2502;     &#x2514;&#x2500; index.json
&#x251C;&#x2500; views/
&#x2502;  &#x2514;&#x2500; index.htm
&#x2514;&#x2500; webconfig.json
</code></pre><p>Avec <code>node-atlas --browse</code>, &#xE0; l&apos;adresse <em><a href="http://localhost/">http://localhost/</a></em> s&apos;affichera la liste des pages composants votre site (gr&#xE2;ce &#xE0; <strong>index</strong> &#xE0; <strong>true</strong>).</p><p>Il ne restera plus qu&apos;&#xE0;, une fois <code>--generate</code> utilis&#xE9;, admirer votre site HTML dans le dossier :</p><pre><code>&#x250A;&#x2509;
&#x251C;&#x2500; serverless/
&#x2502;  &#x251C;&#x2500; stylesheets/
&#x2502;  &#x2502;  &#x2514;&#x2500; common.css
&#x2502;  &#x251C;&#x2500; javascripts/
&#x2502;  &#x2502;  &#x2514;&#x2500; common.js
&#x2502;  &#x251C;&#x2500; cv.html
&#x2502;  &#x2514;&#x2500; en/
&#x2502;     &#x2514;&#x2500; cv.html
&#x250A;&#x2509;
</code></pre><p><em>Note : si</em> <code>serverlessRelativePath</code> <em>n&apos;est pas pr&#xE9;sent dans &#xAB; webconfig.js &#xBB;, par d&#xE9;faut le dossier des g&#xE9;n&#xE9;rations est bien</em> <code>serverless/</code>. <code>serverlessRelativePath</code> <em>est donc utile seulement pour changer le nom/chemin r&#xE9;pertoire.</em></p><h4 id="g-n-rer-les-fichiers-statics">G&#xE9;n&#xE9;rer les fichiers statics</h4><p>Les fichiers d&#xE9;fini dans <code>statics</code> sont &#xE9;galement copiable dans le dossier <code>serverlessRelativePath</code> lors de l&apos;appel &#xE0; <code>--generate</code>. Pour permettre cela, vous pouvez utiliser pour chaque dossier statique le param&#xE8;tre <code>output</code> mis &#xE0; <code>true</code>.</p><pre><code>{
    &quot;statics&quot;: {
        &quot;/javascripts/models&quot;: {
            &quot;path&quot;: &quot;models&quot;,
            &quot;output&quot;: true
        }
    },
}
</code></pre><h3 id="moteur-de-template-ejs">Moteur de template EJS</h3><p>Par d&#xE9;faut, NodeAtlas utilise d&#xE9;j&#xE0; le <a href="http://ejs.co/">moteur de template EJS</a>, c&apos;est ce qui vous permet d&apos;utiliser du JavaScript dans les balises <code>&lt;?</code> et <code>?&gt;</code>.</p><p>Les balises <code>&lt;?</code> et <code>?&gt;</code> permettent d&apos;inclure du JavaScript au sein m&#xEA;me de vos templates. Il existe diff&#xE9;rentes variantes de la balise vous permettant d&apos;afficher le r&#xE9;sultat JavaScript dans votre template (comme vous le feriez avec un <code>document.write</code>). Les voici :</p><ul>
<li><code>&lt;?</code> La balise &#xAB; Scriptlet &#xBB; par d&#xE9;faut, pour les structure de contr&#xF4;le, pas de sortie.</li>
<li><code>&lt;?=</code> Affich&#xE9; le r&#xE9;sultat des expressions dans le template (&#xE9;chappement HTML)</li>
<li><code>&lt;?-</code> Affich&#xE9; le r&#xE9;sultat des expressions dans le template tel quel</li>
<li><code>&lt;?#</code> Balise commentaire, pas d&apos;ex&#xE9;cution, pas de sortie</li>
<li><code>&lt;?%</code> Affiche lit&#xE9;ralement le contenu d&apos;une <code>&lt;?</code></li>
<li><code>?&gt;</code> La balise de fermeture</li>
<li><code>-?&gt;</code> La balise Mode trim, ex&#xE9;cute un trim sur les nouvelles lignes</li>
</ul><p>Cependant, EJS fonctionne normalement avec les balises <code>&lt;%</code> et <code>%&gt;</code>. Vous pouvez remettre ces valeurs ou m&#xEA;me utiliser celles que vous souhaitez.</p><pre><code class="lang-json">{
    &quot;templateEngineDelimiter&quot;: &quot;%&quot;,
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;index.ejs&quot;
        }
    }
}
</code></pre><p>Par exemple, pour inclure une partie de fichier on utilise l&apos;instruction <code>&lt;?- include(&quot;partials/head.htm&quot;) ?&gt;</code>. Il serait possible de le faire avec <code>&lt;%- include(&quot;partials/head&quot;) %&gt;</code> avec la configuration ci-dessous :</p><p>Voyez l&apos;exemple dans les fichiers ci-dessous :</p><p><em>webconfig.json</em></p><pre><code class="lang-json">{
    &quot;templateEngineDelimiter&quot;: &quot;%&quot;,
    &quot;variation&quot;: &quot;common.json&quot;,
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;index.ejs&quot;,
            &quot;variation&quot;: &quot;index.json&quot;
        }
    }
}
</code></pre><p><em>variations/common.json</em></p><pre><code class="lang-json">{
    &quot;titleWebsite&quot;: &quot;Titre du site&quot;,
    &quot;classCssCommon&quot;: &quot;common&quot;,
    &quot;classJsCommon&quot;: &quot;common&quot;
}
</code></pre><p><em>variations/index.json</em></p><pre><code class="lang-json">{
    &quot;titlePage&quot;: &quot;Bienvenue&quot;,
    &quot;classPage&quot;: &quot;index&quot;,
    &quot;content&quot;: &quot;&lt;p&gt;C&apos;est la page d&apos;accueil.&lt;/p&gt;&quot;
}
</code></pre><p><em>views/partials/head.ejs</em></p><pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;fr-fr&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot; /&gt;
        &lt;title&gt;&lt;%- specific.titlePage %&gt;&lt;/title&gt;
        &lt;link type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;stylesheets/&lt;%= common.classCssCommon %&gt;.css&quot; media=&quot;all&quot; /&gt;
        &lt;link type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;stylesheets/&lt;%= specific.classPage %&gt;.css&quot; media=&quot;all&quot; /&gt;
    &lt;/head&gt;
    &lt;body class=&quot;&lt;%= specific.classPage %&gt;&quot;&gt;
</code></pre><p><em>views/partials/foot.ejs</em></p><pre><code class="lang-html">        &lt;script async type=&quot;text/javascript&quot; src=&quot;javascripts/&lt;%= common.classJsCommon %&gt;.js&quot;&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p><em>views/index.ejs</em></p><pre><code class="lang-html">    &lt;%- include(&quot;partials/head&quot;) %&gt;

    &lt;div class=&quot;title&quot;&gt;&lt;%- common.titleWebsite %&gt;&lt;/div&gt;

    &lt;div&gt;
        &lt;h1&gt;&lt;%- specific.titlePage %&gt;&lt;/h1&gt;
        &lt;%- specific.content %&gt;
    &lt;/div&gt;

    &lt;%- include(&quot;partials/foot&quot;) %&gt;
</code></pre><p>Pour tout savoir sur les possibilit&#xE9;s du moteur de template consultez <a href="http://ejs.co/">la documentation EJS</a></p><p><em>Note : si rien n&apos;est pr&#xE9;cis&#xE9;,</em> <code>templateEngineDelimiter</code> <em>vaut</em> <code>?</code>.</p><h3 id="moteur-de-template-pug">Moteur de Template Pug</h3><p>Il est possible d&apos;utiliser en lieu et place de EJS le <a href="https://pugjs.org/">moteur de template Pug</a> (anciennement Jade) pour g&#xE9;n&#xE9;rer les pages et manipuler les variations. Cela est possible pour l&apos;int&#xE9;gralit&#xE9; du site avec par exemple ce webconfig :</p><pre><code class="lang-json">{
    &quot;pug&quot;: true,
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;index.pug&quot;
        },
        &quot;/contenu/&quot;: {
            &quot;view&quot;: &quot;content.pug&quot;
        }
    }
}
</code></pre><p>ou seulement pour une page pr&#xE9;cise :</p><pre><code>{
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;index.pug&quot;
        },
        &quot;/contenu/&quot;: {
            &quot;pug&quot;: true,
            &quot;view&quot;: &quot;content.pug&quot;
        }
    }
}
</code></pre><p>Il est &#xE9;galement possible pour un moteur complet en Pug de repasser une page sp&#xE9;cifique en EJS.</p><pre><code>{
    &quot;pug&quot;: true,
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;pug&quot;: false,
            &quot;view&quot;: &quot;index.pug&quot;
        },
        &quot;/contenu/&quot;: {
            &quot;view&quot;: &quot;content.pug&quot;
        }
    }
}
</code></pre><p>Voyons ce que cela donnerait avec l&apos;exemple suivant :</p><p><em>webconfig.json</em></p><pre><code>{
    &quot;pug&quot;: true,
    &quot;view&quot;: &quot;common.pug&quot;,
    &quot;variation&quot;: &quot;common.json&quot;,
    &quot;routes&quot;: {
        &quot;/&quot;: {
            &quot;view&quot;: &quot;index.pug&quot;,
            &quot;variation&quot;: &quot;index.json&quot;
        }
    }
}
</code></pre><p><em>variations/common.json</em></p><pre><code class="lang-json">{
    &quot;titleWebsite&quot;: &quot;Titre du site&quot;,
    &quot;classCssCommon&quot;: &quot;common&quot;,
    &quot;classJsCommon&quot;: &quot;common&quot;
}
</code></pre><p><em>variations/index.json</em></p><pre><code class="lang-json">{
    &quot;titlePage&quot;: &quot;Bienvenue&quot;,
    &quot;classPage&quot;: &quot;index&quot;,
    &quot;content&quot;: &quot;&lt;p&gt;C&apos;est la page d&apos;accueil.&lt;/p&gt;&quot;
}
</code></pre><p><em>views/common.pug</em></p><pre><code class="lang-html">doctype html
html(lang=&quot;fr-fr&quot;)
    head
        meta(charset=&quot;utf-8&quot;)
        title #{specific.titlePage}
        link(type=&quot;text/css&quot;, rel=&quot;stylesheet&quot;, href=&quot;stylesheets/&quot; + common.classCssCommon + &quot;.css&quot;, media=&quot;all&quot;)
        link(type=&quot;text/css&quot;, rel=&quot;stylesheet&quot;, href=&quot;stylesheets/&quot; + specific.classPage + &quot;.css&quot;, media=&quot;all&quot;)
    body(class=specific.classPage)
        include partials/header
        include #{routeParameters.view}
        script(async, type=&quot;text/javascript&quot;, src=&quot;javascripts/&quot; + common.classJsCommon + &quot;.js&quot;)
</code></pre><p><em>views/partials/header.pug</em></p><pre><code class="lang-html">h1 #{titleWebsite}
</code></pre><p><em>views/index.pug</em></p><pre><code class="lang-html">div
    h2 #{specific.titlePage}
    | !{specific.content}
</code></pre><p>Pour tout savoir sur les possibilit&#xE9;s du moteur de template consultez <a href="https://pugjs.org/">la documentation Pug</a></p><p><em>Note : si rien n&apos;est pr&#xE9;cis&#xE9;,</em> <code>pug</code> <em>vaut</em> <code>false</code>.</p><h3 id="moteur-de-template-vue">Moteur de Template Vue</h3><p><a href="https://vuejs.org/">Vue</a> est un framework MVVM &#xE9;volutif comme Angular ou React qui est utilisable en tant que moteur de rendu c&#xF4;t&#xE9; serveur pour NodeAtlas. L&apos;avantage ici, c&apos;est que c&#xF4;t&#xE9; client il reprend la main en hydratant le code g&#xE9;n&#xE9;r&#xE9; depuis le serveur pour le rendre r&#xE9;actif c&#xF4;t&#xE9; client !</p><blockquote>
<p>N&apos;h&#xE9;sitez pas &#xE0; reconsulter cette partie plus tard car elle utilise divers m&#xE9;canismes de contr&#xF4;leur que nous allons apprendre &#xE0; utiliser dans la prochaine partie.</p>
</blockquote><p>Nous vous proposons de mettre en place l&apos;utilisation de <a href="https://fr.vuejs.org/">Vue</a> + <a href="https://router.vuejs.org/fr/">Vue Router</a> + <a href="https://ssr.vuejs.org/fr/">Vue Server Renderer</a> &#xE0; travers la commande suivante :</p><pre><code class="lang-bash">node-atlas --create hello-vue
</code></pre><p>puis de l&apos;initialiser &#xE0; l&apos;aide de la commande</p><pre><code class="lang-bash">cd ./hello-vue/
npm install
</code></pre><p>et enfin de le d&#xE9;marrer avec la commande</p><pre><code class="lang-bash">node-atlas --browse
</code></pre><ul>
<li><a href="https://github.com/Haeresis/node-atlas-hello-vue">Retrouvez les sources et toutes les explications d&apos;utilisation sur le d&#xE9;p&#xF4;t GitHub d&#xE9;di&#xE9;</a></li>
</ul><div><div class="before">
							<a href="commencer-avec-nodeatlas.html">&#x25C4; Commencer avec NodeAtlas</a>
						</div><div class="after">
							<a href="partie-controleur-et-modele.html">Partie contr&#xF4;leur et mod&#xE8;le &#x25BA;</a>
						</div></div>
				</div>
			</div>
		</div>
		<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>
		
		<script id="channel" data-channel="NodeAtlas/Aide" data-label="Chat d&apos;Aide" src="javascripts/common.min.js"></script>
		
		<script src="https://buttons.github.io/buttons.js"></script>
	
</body></html>